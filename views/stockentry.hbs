<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.3.1/dist/css/bootstrap.min.css"
        integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"
        integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo"
        crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.14.7/dist/umd/popper.min.js"
        integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1"
        crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.3.1/dist/js/bootstrap.min.js"
        integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM"
        crossorigin="anonymous"></script>
    <style>
        input{
            width: 200px;
        }
        button{
            width:200px;
        }
        #search {
            border: 2px solid black;
            position: absolute;
            left: 88%;
            top: 0px;
            z-index: -1;
            wi text-align: center;
        }
        #input{
            border: 2px solid black;
        }
        #header input
        {
           background-color: burlywood;
        }
        #gstop input{
            border: 2px solid white;
           width: 200px;
        }
    </style>
</head>

<body><br>
        
    <div class="container">
        <div class="row">
            <div class="col-md-6" style="font-weight: bolder; border: 2px solid black;">
                seller:-
                <br>    
                {{name}},<br>
        {{#each address}}
        {{this}},<br>
        {{/each}}
        {{state}},<br>
        {{pin}},<br>
        {{gst}},<br>
            </div>
            <div class="col-md-6" style="border:2px solid black">
                <div class="row">
          <div class="col-md-8" style="border:2px solid black">
            <div class="row">
              <div class="col-md-6">
                invoice<br>
                {{invoice}}
              </div>
              <div class="col-md-6">
                e-wall BillNo
                <input type="text">
              </div>
            </div>
          </div>
          <div class="col-md-4" style="border:2px solid black">
            date<br>
           <input type="text">
          </div>
        </div>
            </div>
        </div>
    
    <div class="row">
        <div class="col-md-6" style="border:2px solid black;font-weight:bolder">
            buyer:- <br>
        VLS Body BUILDERS<br>
        Salem MainRoad,<BR>
            Sankagiri,<BR>
            Salem.<BR>
            GSTIN/UIN:29890878AEE <BR>
            ph:7708179320<br>
        </div>
        <div class="col-md-6" style="border:2px solid black">

        </div>
        
    </div>
       </div>
       <br>
       <br> 
    <div class="row">
        <div class="col-md-2">
            <button onclick="add()">Add a row</button><br>
             <button onclick="remove()"> Delete a row</button>
             <button onclick="putgst()">Put Gst</button>
             <button onclick="datas()">Add a Stocks</button>
        </div>
        <div class="col-md-9" id="input" >
            <div class="div" id="header">
                
            <input type="text" placeholder="sno" disabled>
                <input type="text"  placeholder="productname" disabled>
                <input type="text"  placeholder="quantity" disabled>
                <input type="text" placeholder="rate" disabled>
                <select name="" disabled>
                    <option value="0">GST</option>
                    <option value="5">05%</option>
                    <option value="18">18%</option>
                    <option value="28">28%</option>
                </select>
                <input type="text"  placeholder="total" disabled>
                </div>
            <div class="inputbox" id="inputbox">
                <br>
                <input type="text" name="" id="sno" class="sno" placeholder="sno">
                <input type="text" class="productname" id="productname"  placeholder="productname"
                    onkeyup="search(this.value)">
                <input type="text" class="quantity" id="quantity" placeholder="quantity">
                <input type="text" class="rate" id="rate" placeholder="rate">
                <select name="" id="Gst" class="gst">
                    <option value="0">0%</option>
                    <option value="5">05%</option>
                    <option value="18">18%</option>
                    <option value="28">28%</option>
                </select>
                <input type="text" class="total" id="total" placeholder="total" onclick="total()">
                
            </div>
        </div>
   
    <div class="col-md-1">
        <div id="search1">

        </div>
    </div>
    </div>
    
    <div id="gstop" style="display: none;">
        <br>
        <br>
        <input type="text" disabled>
        <input type="text" disabled>
        <input type="text" disabled>
        <input type="text" name="" id="" placeholder="GST" disabled>
        <select name="" id="" disabled>
            <option value="">05%</option>
        </select>
        <input type="text" name="" id="five" value="0" disabled>
        <input type="text" disabled>
        <input type="text" disabled>
        <input type="text" disabled>
        <input type="text" disabled placeholder="GST">
        <select name="" id="" disabled>
            <option>18%</option>
        </select>
        <input type="text" name="" id="eighteen" value="5"disabled>
        <input type="text" disabled>
        <input type="text" disabled>
        <input type="text" disabled>
        <input type="text" disabled placeholder="GST">
        <select name="" id="" disabled>
            <option value="">28%</option>
        </select>
        <input type="text" name="" id="twenty" value="10" disabled>
          <input type="text" disabled>
        <input type="text" disabled>
        <input type="text" disabled>
        <input type="text" disabled placeholder="TOTAL">
        <select name="" id="" style="width: 55px"disabled>
            <option value=""></option>
        </select>
        <input type="text" name="" id="tot" value="0" disabled>
    </div>
    <div id="totalbill">
         
    </div>
    <p  id="p" style="display:none">{{name}}</p>
    <p id="p1"  style="display:none">{{invoice}}</p>
</body>
<script>
    var five=0;
    var eighteen=0;
    var twenty=0;
    function add() {
        const i = document.createElement('div');
        i.setAttribute('id', 'inputbox');
        i.setAttribute('class', 'inputbox')
        const g = document.getElementsByClassName('sno');
        const p = document.getElementById('inputbox');
        i.insertAdjacentHTML('beforeend', p.innerHTML);
        document.getElementById('input').appendChild(i);
    }
    function remove() {
        const y = document.getElementsByClassName('inputbox').length;
        if (y > 1)
            document.getElementById('input').remove();
    }

    function search(e) {

        fetch(`search?y=${e}`).then(res => res.json()).then(data => {
            let r = data.ar;
            if (r.length == 0) {
                const para = document.createElement("p");
                const node = document.createTextNode("Sorry Not found");
                para.appendChild(node);
                const element = document.getElementById("search1");
                element.innerHTML = '';
                element.appendChild(para);
            }
            else {
                const element = document.getElementById("search1");
                element.innerHTML = '';
                for (var i = 0; i < r.length; i++) {

                    const hr = document.createElement('hr');
                    const para = document.createElement("p");
                    const u = r[i];
                    const node = document.createTextNode(r[i]);
                    para.setAttribute("onclick", "value1(this.innerHTML)");
                    para.appendChild(node);
                    element.appendChild(para);
                    element.appendChild(hr);
                }
            }
        })
    }

    function value1(e) {
        const y = document.getElementsByClassName('productname').length;
        document.getElementsByClassName('productname')[y - 1].value = e;
    }
    
    function total(){
        
        const y=document.getElementsByClassName('total');
        const y1=document.getElementsByClassName('quantity')[y.length-1].value;
        const y2=document.getElementsByClassName('rate')[y.length-1].value;
        const y3=document.getElementsByClassName('gst')[y.length-1].value;
        var sump=(y1*(y2))-((y1*(y2))*(100/(100+parseInt(y3))));
        sump=Math.round(sump)
        if(y3==5){
            five+=sump;
        }
        else if(y3==18){
             eighteen+=sump;
        }
        else if(y3==28){
            twenty+=sump;
        }
        document.getElementsByClassName('total')[y.length-1].value=y1*y2-Math.round(sump);
    }
   
   function putgst(){
    console.log('op');
            const r=document.getElementById('gstop')
            document.getElementById('five').value=five;
            document.getElementById('eighteen').value=eighteen;
            document.getElementById('twenty').value=twenty;    
            document.getElementById('input').appendChild(r);
            const p=document.getElementsByClassName('total');
            var yu=five+eighteen+twenty;
            for(var  i=0;i<p.length;i++){
                yu+=parseInt(p[i].value);
            }
            document.getElementById('tot').value=yu;
           // document.getElementById('tot').style.display='none';
             r.style.display='block';
   }
   function datas(){
             const pro=document.getElementsByClassName('productname');
             const quan=document.getElementsByClassName('quantity');
             const rat0=document.getElementsByClassName('rate');
             const inv=document.getElementById('p1').innerHTML;
             var proarr='';
             var quanarr='';
             var rat1='';
             const name=document.getElementById('p').innerHTML;
             const total=document.getElementById('tot').value;
             for(var i=0;i<pro.length;i++){
                  proarr+=pro[i].value+',';
                  quanarr+=quan[i].value+',';
                 rat1+=rat0[i].value+',';
             }
             window.location.url="http://localhost:1000/options"
             fetch('stockdata',{
                method:'POST',
                headers:{'Content-Type': 'application/json'},
                 body:JSON.stringify({pr:proarr,quantity:quanarr,rate:rat1,name:name,invoice:inv,total:total})
             })
   }

</script>

</html>